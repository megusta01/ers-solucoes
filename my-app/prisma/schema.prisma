generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id           String   @id @default(uuid())
  nome         String
  email        String   @unique
  senha        String   @map("senha_hash")
  criadoEm     DateTime @default(now())
  atualizadoEm DateTime @updatedAt
  telefones    String[]

  Pedido Pedido[]
  Avaliacao Avaliacao[]
  Mensagem Mensagem[]
}

model Pedido {
  id           String   @id @default(uuid())
  usuario      Usuario  @relation(fields: [usuarioId], references: [id])
  usuarioId    String
  produtos     Produto[]
  criadoEm     DateTime @default(now())
  atualizadoEm DateTime @updatedAt
}

model Produto {
  id           String   @id @default(uuid())
  nome         String
  descricao    String
  preco        Float
  criadoEm     DateTime @default(now())
  atualizadoEm DateTime @updatedAt

  Pedido Pedido[]
  Avaliacao Avaliacao[]
}

model Mensagem {
  id String @id @default(uuid())
  usuario Usuario @relation(fields: [id], references: [id])
  usuarioId String
  conteudo String 
  criadoEm DateTime @default(now())
}

model Avaliacao {
  id           String   @id @default(uuid())
  produto      Produto  @relation(fields: [produtoId], references: [id])
  produtoId    String
  usuario      Usuario  @relation(fields: [usuarioId], references: [id])
  usuarioId    String
  nota         Int
  comentario   String?
  criadoEm     DateTime @default(now())
  atualizadoEm DateTime @updatedAt
}

model Administrador {
  id           String   @id @default(uuid())
  nome         String
  email        String   @unique
  senha        String   @map("senha_hash")
  criadoEm     DateTime @default(now())
  atualizadoEm DateTime @updatedAt
}